Schema	
Object Type	
Object Name	
Script
Script
Generated DDL
CREATE TABLE  "FACT_MOVIES" 
   (	"ID_PK" NUMBER, 
	"DT_LOAD" DATE, 
	"GENRE" VARCHAR2(4000), 
	"YEAR" NUMBER, 
	"MOVIE_TITLE" VARCHAR2(255), 
	"RATING_SYSTEM1" NUMBER, 
	"RATING_SYSTEM2" NUMBER, 
	"RATING_SYSTEM3" NUMBER, 
	"RATING_SYSTEM4" NUMBER, 
	"ID_SYSTEM1" NUMBER, 
	"ID_SYSTEM_2" NUMBER, 
	"ID_SYSTEM_3" NUMBER, 
	"ID_SYSTEM_4" NUMBER, 
	"IF_IS_SYSTEM1_FLG" CHAR(1), 
	"IF_IS_SYSTEM2_FLG" CHAR(1), 
	"IF_IS_SYSTEM3_FLG" CHAR(1), 
	"IF_IS_SYSTEM4_FLG" CHAR(1), 
	"ID_SOUND" NUMBER, 
	"ID_IMAGINE" NUMBER, 
	"ID_PROC_PROCESSED" NUMBER, 
	"SCORE_VOTING_S1" NUMBER, 
	"SCORE_VOTING_S2" NUMBER, 
	"SCORE_VOTING_S3" NUMBER, 
	"SCORE_VOTING_S4" NUMBER, 
	"MEASURES_SYSTEM1" NUMBER, 
	"MEASURES_SYSTEM2" NUMBER, 
	"MEASURES_SYSTEM3" NUMBER, 
	"MEASURES_SYSTEM4" NUMBER, 
	"FINAL_SC_CALCULATED" NUMBER, 
	 CONSTRAINT "FACT_MOVIES_CON" PRIMARY KEY ("ID_PK")
  USING INDEX  ENABLE
   )
/
CREATE TABLE  "PLATFORM_1" 
   (	"ID_SYSTEM1" NUMBER, 
	"PLATFORM_NM" VARCHAR2(400), 
	"DT_MV_RECORDED" DATE, 
	"DT_MV_PRODUCED" NUMBER, 
	"RATING" NUMBER, 
	"MOVIE_NM" VARCHAR2(400), 
	"MOVIE_GEN_DESC" VARCHAR2(400), 
	"number_of_votes" NUMBER, 
	 CONSTRAINT "PLATFORM_1_CON" PRIMARY KEY ("ID_SYSTEM1")
  USING INDEX  ENABLE
   )
/
CREATE TABLE  "DIM_SCREENPLAY" 
   (	"ID" NUMBER, 
	"SCREENPLAY_DESC" VARCHAR2(400), 
	 CONSTRAINT "DIM_SCREENPLAY_CON" PRIMARY KEY ("ID")
  USING INDEX  ENABLE
   )
/
CREATE TABLE  "PLATFORM_2" 
   (	"ID_SYSTEM2" NUMBER, 
	"PLATFORM_NM" VARCHAR2(400), 
	"DT_MV_RECORDED" DATE, 
	"DT_MV_PRODUCED" NUMBER, 
	"RATING" NUMBER, 
	"MOVIE_NM" VARCHAR2(400), 
	"MOVIE_GEN_DESC" VARCHAR2(400), 
	"number_of_votes" NUMBER, 
	 CONSTRAINT "PLATFORM_2_CON" PRIMARY KEY ("ID_SYSTEM2")
  USING INDEX  ENABLE
   )
/
CREATE TABLE  "DIM_SOUND" 
   (	"ID_SOUND" NUMBER, 
	"SOUND_DESC" VARCHAR2(400), 
	 CONSTRAINT "DIM_SOUND_CON" PRIMARY KEY ("ID_SOUND")
  USING INDEX  ENABLE
   )
/
CREATE TABLE  "DIM_PERF" 
   (	"ID_PK" NUMBER, 
	"PERF_DESC" VARCHAR2(400), 
	 CONSTRAINT "DIM_PERF_CON" PRIMARY KEY ("ID_PK")
  USING INDEX  ENABLE
   )
/
CREATE TABLE  "ROTEN_TMP" 
   (	"ID" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE  NOT NULL ENABLE, 
	"ID_MOVI" NUMBER, 
	"TITLE" VARCHAR2(255), 
	"YEAR" NUMBER, 
	"CRITIC_SCORE" NUMBER, 
	"PEOPLE_SCORE" NUMBER, 
	"TOTAL_REVIEWS" NUMBER, 
	"TOTAL_RATINGS" NUMBER, 
	"TYPE" VARCHAR2(50), 
	"GENRE" VARCHAR2(255), 
	"BOX_OFFICE" VARCHAR2(50), 
	 CONSTRAINT "ROTEN_TMP_CON" PRIMARY KEY ("ID")
  USING INDEX  ENABLE
   )
/
CREATE TABLE  "DIM_TIME" 
   (	"DAY_ID" DATE, 
	"DAY_DESC" VARCHAR2(45), 
	"DAY_NAME" VARCHAR2(36), 
	"DAY_OF_WEEK" NUMBER, 
	"DAY_OF_MONTH" NUMBER, 
	"DAY_OF_YEAR" NUMBER, 
	"DAYS_IN_DAY" NUMBER, 
	"MONTH_ID" VARCHAR2(8), 
	"MONTH_DESC" VARCHAR2(41), 
	"MONTH_OF_QUARTER" NUMBER, 
	"MONTH_OF_YEAR" NUMBER, 
	"MONTH_NAME" VARCHAR2(36), 
	"END_OF_MONTH" DATE, 
	"DAYS_IN_MONTH" VARCHAR2(2), 
	"QUARTER_ID" VARCHAR2(7), 
	"QUARTER_DESC" VARCHAR2(17), 
	"QUARTER_OF_YEAR" NUMBER, 
	"END_OF_QUARTER" DATE, 
	"DAYS_IN_QUARTER" NUMBER, 
	"YEAR_ID" NUMBER, 
	"DAYS_IN_YEAR" NUMBER, 
	"END_OF_YEAR" DATE, 
	"DAYS_IN_WEEK" NUMBER, 
	"CAL_WEEK_ID" VARCHAR2(9), 
	"CAL_WEEK_DESC" VARCHAR2(71), 
	"CAL_WEEK_OF_YEAR" NUMBER, 
	"END_OF_CAL_WEEK" DATE, 
	 CONSTRAINT "DIM_TIME_CON" PRIMARY KEY ("DAY_ID")
  USING INDEX  ENABLE
   )
/
CREATE TABLE  "IMDB_TMP" 
   (	"ID" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE  NOT NULL ENABLE, 
	"RANK" NUMBER, 
	"TITLE" VARCHAR2(255), 
	"GENRE" VARCHAR2(50), 
	"DESCRIPTION" VARCHAR2(4000), 
	"DIRECTOR" VARCHAR2(50), 
	"ACTORS" VARCHAR2(255), 
	"YEAR" NUMBER, 
	"RUNTIME_MIN" NUMBER, 
	"RATING" NUMBER, 
	"VOTES" NUMBER, 
	"REVENUE__MILLIONS_" NUMBER, 
	"METASCORE" NUMBER, 
	 CONSTRAINT "IMDB_TMP_CON" PRIMARY KEY ("ID")
  USING INDEX  ENABLE
   )
/
CREATE TABLE  "PLATFORM_3" 
   (	"ID_SYSTEM3" NUMBER, 
	"PLATFORM_NM" VARCHAR2(400), 
	"DT_MV_RECORDED" DATE, 
	"DT_MV_PRODUCED" NUMBER, 
	"RATING" NUMBER, 
	"MOVIE_NM" VARCHAR2(400), 
	"MOVIE_GEN_DESC" VARCHAR2(400), 
	"number_of_votes" NUMBER, 
	 CONSTRAINT "PLATFORM_3_CON" PRIMARY KEY ("ID_SYSTEM3")
  USING INDEX  ENABLE
   )
/
CREATE OR REPLACE EDITIONABLE FUNCTION  "F_TEST" (p_string in varchar2)
   return varchar
   is
     l_output_string varchar2(4000) :='';
   begin
   FOR X IN (
     with data_rows  as
     (
     select
       trim( substr (txt,
             instr (txt, ',', 1, level  ) + 1,
             instr (txt, ',', 1, level+1)
                - instr (txt, ',', 1, level) -1 ) )
         as token
       from (select ','||p_string||',' txt
               from dual)
     connect by level <=
        length(p_string)-length(replace(p_string,',',''))+1
     )
    SELECT distinct * FROM data_rows)
   LOOP
     l_output_string :=l_output_string||', '||x.token;
   END LOOP;
   return substr(l_output_string,3);
  END;
/

CREATE OR REPLACE EDITIONABLE FUNCTION  "NO_DUP_WORDS" (ar_param varchar2)
    return varchar2
    as
    v_working varchar2(4096) := '';
    v_result varchar2(4096) := '';
    v_word varchar2(4096) := '';
    begin
       v_working := replace(ar_param, ' ', '  ') || ' ';
       while v_working is not null loop
         v_working := ltrim(v_working);
         v_word := ' '||trim(substr(v_working, 1 ,instr(v_working, ' ')))||' ';
         v_result := v_result || ' ' || trim(v_word);
         v_working := ' '||v_working;
         v_working := ltrim(replace(v_working, v_word, ''));
      end loop;
      return trim(v_result);
   end;
/

CREATE UNIQUE INDEX  "DIM_PERF_CON" ON  "DIM_PERF" ("ID_PK")
/
CREATE UNIQUE INDEX  "DIM_SCREENPLAY_CON" ON  "DIM_SCREENPLAY" ("ID")
/
CREATE UNIQUE INDEX  "DIM_SOUND_CON" ON  "DIM_SOUND" ("ID_SOUND")
/
CREATE UNIQUE INDEX  "DIM_TIME_CON" ON  "DIM_TIME" ("DAY_ID")
/
CREATE UNIQUE INDEX  "FACT_MOVIES_CON" ON  "FACT_MOVIES" ("ID_PK")
/
CREATE UNIQUE INDEX  "IMDB_TMP_CON" ON  "IMDB_TMP" ("ID")
/
CREATE UNIQUE INDEX  "PLATFORM_1_CON" ON  "PLATFORM_1" ("ID_SYSTEM1")
/
CREATE UNIQUE INDEX  "PLATFORM_2_CON" ON  "PLATFORM_2" ("ID_SYSTEM2")
/
CREATE UNIQUE INDEX  "PLATFORM_3_CON" ON  "PLATFORM_3" ("ID_SYSTEM3")
/
CREATE UNIQUE INDEX  "ROTEN_TMP_CON" ON  "ROTEN_TMP" ("ID")
/
